{% extends 'base.html' %}

{% block content %}
    <h2>{{ post.title }}</h2>
    {% if post.image %}
        <img src="{{ post.image.url }}" alt="{{ post.title }} image">
    {% endif %}
    <p>Author: {{ post.user.username }}</p>
    <p>Created at: {{ post.created_date }}</p>
    <p>Published on: {{ post.published_date }}</p>
    <p>{{ post.description }}</p>
    <p>
        <strong>Likes:</strong> {{ post.likes.count }} &nbsp;
        <form method="post" action="{% url 'webapp:like_post' post.id %}" style="display: inline;">
            {% csrf_token %}
            {% if request.user in post.likes.all %}
                <button type="submit">Unlike</button>
            {% else %}
                <button type="submit">Like</button>
            {% endif %}
        </form>
    </p>
    <h3>Comments:</h3>
    <ul>
        {% for comment in comments %}
            <li>
                <strong>{{ comment.user.username }}</strong> - {{ comment.created_date }}<br>
                {{ comment.content }}
                {% if request.user == comment.user %}
                    <form method="post" action="{% url 'webapp:delete_comment' comment.id %}" style="display: inline;">
                        {% csrf_token %}
                        <button type="submit">Delete</button>
                    </form>
                {% endif %}
            </li>
        {% empty %}
            <li>No comments yet.</li>
        {% endfor %}
    </ul>
    <form method="post" action="{% url 'webapp:add_comment' post.id %}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Submit Comment</button>
    </form>
{% endblock %}
